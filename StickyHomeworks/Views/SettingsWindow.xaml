<ely:MyWindow x:Class="StickyHomeworks.Views.SettingsWindow"
                   xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                   xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                   xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                   xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                   xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
                   xmlns:controls="clr-namespace:StickyHomeworks.Controls"
                   xmlns:models="clr-namespace:StickyHomeworks.Models"
                     xmlns:emoji="clr-namespace:Emoji.Wpf;assembly=Emoji.Wpf"
                   xmlns:services="clr-namespace:StickyHomeworks.Services"
                   mc:Ignorable="d"
                   d:DataContext="{d:DesignInstance views:SettingsWindow}"
                   TextElement.Foreground="{DynamicResource MaterialDesignBody}"
                   Background="{DynamicResource MaterialDesignPaper}"
                   FontFamily="{StaticResource MiSans}"
                   TextElement.FontWeight="Regular"
                   TextElement.FontSize="14"
                   TextOptions.TextFormattingMode="Ideal" 
                   TextOptions.TextRenderingMode="Auto"   
                   Title="应用设置" Height="550" Width="1200"
                   Icon="/Assets/AppLogo.png"
                   MinWidth="600"
                   Closing="SettingsWindow_OnClosing"
                   FrameworkElement.FocusVisualStyle="{StaticResource {x:Static SystemParameters.FocusVisualStyleKey}}"
                   xmlns:mdWpf="clr-namespace:MaterialDesignThemes.Wpf;assembly=MaterialDesignThemes.Wpf"
                   xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
                   xmlns:sys="clr-namespace:System;assembly=System.Runtime"
                   xmlns:ely="http://github.com/HelloWRC/ElysiaFramework"
                   xmlns:ci="clr-namespace:StickyHomeworks"
                   xmlns:views="clr-namespace:StickyHomeworks.Views"
                    xmlns:mdxam="clr-namespace:MdXaml;assembly=MdXaml">
    <Window.Resources>
        <Style TargetType="ListBoxItem" BasedOn="{StaticResource MaterialDesignListBoxItem}"
               x:Key="NotificationsListBoxItemStyle">
        </Style>

        <Style x:Key="CustomMarkdownStyle" TargetType="FlowDocument">
            <Setter Property="FontFamily" Value="MiSans"/>
            <Setter Property="FontWeight" Value="Bold"/>

        </Style>

        <ely:ColorToColorPickerBrushConverter x:Key="ColorToColorPickerBrushConverter"/>
        <Style TargetType="StackPanel" x:Key="SettingsPageStackPanelStyle">
            <Setter Property="Margin" Value="12"/>
            <Setter Property="MaxWidth" Value="750"/>
            <Style.Resources>
                <Style TargetType="ely:SettingsCard">
                    <Setter Property="Margin" Value="0 0 0 6"/>
                </Style>
            </Style.Resources>
        </Style>
        <Style TargetType="ScrollViewer">
            <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="materialDesign:ScrollViewerAssist.IsAutoHideEnabled" Value="True"/>
            <Setter Property="PanningMode" Value="Both"/>
        </Style>
        <ely:IntToStringConverter x:Key="IntToStringConverter" />

        <Grid x:Key="OpenSourceLicense" Margin="16" Height="400" Width="550" MaxHeight="{Binding Height}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <TextBlock Grid.Row="0" Text="开放源代码许可" Style="{StaticResource MaterialDesignHeadline5TextBlock}"/>
            <TextBox Grid.Row="1" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="0 12 0 0"
                     Padding="8" Text="{Binding ViewModel.License, Mode=OneWay}" IsReadOnly="True"
                     VerticalScrollBarVisibility="Auto" FontFamily="Consolas"
                     />
            <TextBox Grid.Row="1" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="0 12 0 0"
          Padding="8" Text="                                    GNU GENERAL PUBLIC LICENSE"/>
            <Button Grid.Row="2" Style="{StaticResource MaterialDesignFlatButton}" Content="确定" 
                    HorizontalAlignment="Right" Margin="0 8 0 0"
                    Command="{x:Static materialDesign:DialogHost.CloseDialogCommand}">
            
            </Button>
        </Grid>

        <Grid Margin="16" x:Key="ContributorsDrawer" Width="300">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            <TextBlock Grid.Row="0" Text="贡献人员" Style="{StaticResource MaterialDesignHeadline5TextBlock}"/>
            <ListView Grid.Row="1" Margin="0 6 0 0"
                      materialDesign:ListBoxItemAssist.ShowSelection="False">
                <ListView.ItemTemplate>
                    <DataTemplate DataType="{x:Type models:ContributionMember}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Image Grid.Column="0" VerticalAlignment="Center"
                                   Margin="0 0 6 0" Source="{Binding AvatarImage}"
                                   Width="32" Height="32">
                                <Image.Clip>
                                    <RectangleGeometry RadiusX="16" RadiusY="16"
                                                       Rect="0,0,32,32" />
                                </Image.Clip>
                            </Image>
                            <TextBlock Grid.Column="1" TextWrapping="Wrap">
                                <Run FontSize="15"
                                     Text="{Binding Name, Mode=OneWay}" />
                                <LineBreak />
                                <Run FontSize="11"
                                     FontWeight="Light"
                                     Text="{Binding Description, Mode=OneWay}" />
                            </TextBlock>
                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>
                <models:ContributionMember
                    AvatarImage="/Assets/Contributiors/HelloWRC@64w.jpg"
                    Name="HelloWRC" Description="软件作者，写代码巨水（划掉）" />
                <models:ContributionMember
                   AvatarImage="/Assets/Contributiors/11.jpg"
                   Name="JIzilin" Description="我告诉你们啊 这个姓纪的写代码拉的要史！" />
                <models:ContributionMember
                    AvatarImage="/Assets/Contributiors/unDefFtr.jpg"
                    Name="unDefFtr" Description="更新服务器与网站" />
                <models:ContributionMember
                AvatarImage="/Assets/Contributiors/hello8693.jpg"
                 Name="hello8693" Description="更新服务器与网站" />
                <models:ContributionMember
                AvatarImage="/Assets/Contributiors/课是乐队(´∀｀)♡ClassiSBand.jpg"
                  Name="课是乐队(´∀｀)♡ClassiSBand" Description="群主的喵梁👯‍♂️" />
                <models:ContributionMember
                AvatarImage="/Assets/Contributiors/Shompinice.jpg"
                  Name="Shompinice" Description="绘画大师🖐" />
                <models:ContributionMember
               AvatarImage="/Assets/Contributiors/Jursin.jpg"
                 Name="Jursin" Description="本项目GitHub主页设计" />
                <models:ContributionMember
           AvatarImage="/Assets/Contributiors/Neuvillette.jpg"
             Name="Neuvillette" Description="贡献大🐂" />
            </ListView>
        </Grid>

        <Grid Margin="16" x:Key="ThirdPartyLibs" Width="300">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            <TextBlock Grid.Row="0" Text="第三方库" Style="{StaticResource MaterialDesignHeadline5TextBlock}"/>
            <ListView Grid.Row="1" Margin="0 6 0 0" HorizontalContentAlignment="Stretch">
                <ListView.ItemTemplate>
                    <DataTemplate DataType="{x:Type models:ContributionLabel}">
                        <Grid>
                            <Grid.ToolTip>
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="License"
                                                                 Margin="0 0 3 0" />
                                        <TextBlock Text="{Binding License}"
                                                   Margin="0 0 12 0" TextWrapping="Wrap" />
                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="Web"
                                                                 Margin="0 0 3 0" />
                                        <TextBlock Text="{Binding Website}"
                                                   Margin="0 0 12 0" TextWrapping="Wrap" />
                                    </StackPanel>
                                </StackPanel>
                            </Grid.ToolTip>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <materialDesign:PackIcon Grid.Row="0" Grid.Column="0"
                                                     Kind="PackageVariant" VerticalAlignment="Center"
                                                     Margin="0 0 6 0" />
                            <TextBlock Grid.Row="0" Grid.Column="1"
                                       Text="{Binding Title}"
                                       VerticalAlignment="Center" FontSize="14"
                                       FontWeight="Bold" TextWrapping="Wrap" />
                            <!--<TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Description}"  Margin="0 3 0 0" TextWrapping="Wrap"/>-->
                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>
                <models:ContributionLabel Title="ElysiaFramework"
                                          License="GPLv3"
                                          Website="-" />
                <models:ContributionLabel Title="MaterialDesignInXamlToolkit"
                                          License="MIT License"
                                          Website="https://github.com/MaterialDesignInXAML/MaterialDesignInXamlToolkit/" />
                <models:ContributionLabel Title="gong-mdWpf-dragdrop"
                                          License="BSD 3-Clause"
                                          Website="https://github.com/punker76/gong-mdWpf-dragdrop" />
                <models:ContributionLabel Title="H.NotifyIcon.Wpf"
                                          License="MIT License"
                                          Website="https://github.com/HavenDV/H.NotifyIcon" />
                <models:ContributionLabel Title="MdXaml"
                                          License="MIT License"
                                          Website="https://github.com/whistyun/MdXaml" />
                <models:ContributionLabel Title="云母工艺"
                                          License="云母工艺"
                                          Website="https://github.com/MicaApps" />
                <models:ContributionLabel Title="Microsoft.AppCenter"
                                          License="MIT License"
                                          Website="https://aka.ms/telgml" />
                <models:ContributionLabel Title="Downloader"
                                          License="MIT License"
                                          Website="https://github.com/bezzad/Downloader" />
                <models:ContributionLabel Title="mdWpf-notifyicon"
                                          License="The Code Project Open License (CPOL) 1.02"
                                          Website="https://github.com/hardcodet/mdWpf-notifyicon" />
                <models:ContributionLabel Title="MiSans" License="-"
                                          Website="https://hyperos.mi.com/font/download" />
                <models:ContributionLabel Title="MVVM Toolkit"
                                          Website="https://github.com/CommunityToolkit/dotnet"
                                          License="MIT License" />
                <models:ContributionLabel Title="WPF" License="MIT License"
                                          Website="https://github.com/dotnet/mdWpf" />
                <models:ContributionLabel Title=".NET" License="MIT License"
                                          Website="https://github.com/microsoft/dotnet" />
            </ListView>
        </Grid>

        <ScrollViewer Width="332" x:Key="ExperimentalSettings" 
                      VerticalScrollBarVisibility="Auto"
                      materialDesign:ScrollViewerAssist.IsAutoHideEnabled="True">
            <StackPanel Margin="16">
                <TextBlock Text="实验性功能" Style="{StaticResource MaterialDesignHeadline5TextBlock}"
                           Margin="0 0 0 4"/>
                <TextBlock Text="正在开发/测试的不稳定功能，可能会出现Bug等问题，请谨慎使用。" TextWrapping="Wrap"
                           Margin="0 0 0 16"/>
                <ely:SettingsCard IconGlyph="Eject" Header="选择回档文件"
                       Description="回档按钮允许用户选择的json备份文件。"
                       IsOn="{Binding Settings.Recover, Mode=TwoWay}" />
                
            </StackPanel>
        </ScrollViewer>
        <ely:BooleanToBooleanReConverter x:Key="BooleanToBooleanReConverter" />
        <StackPanel x:Key="EditSubjectDialog" VerticalAlignment="Stretch" Margin="16" MaxWidth="400">
            <TextBlock Style="{StaticResource MaterialDesignHeadline6TextBlock}" Text="编辑科目" VerticalAlignment="Center" HorizontalAlignment="Center" />
            <TextBox Margin="0 6 0 0" TextWrapping="Wrap"
                     Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                     Text="{Binding ViewModel.SubjectEditText}"
                     materialDesign:HintAssist.Hint="科目名称"/>
            <StackPanel Orientation="Horizontal" Margin="0 30 200 0" HorizontalAlignment="Right">
                <Button Content="确定" HorizontalAlignment="Right"  Style="{DynamicResource MaterialDesignFlatButton}" Command="{x:Static materialDesign:DialogHost.CloseDialogCommand}" 
                        CommandParameter="{Binding ViewModel.SubjectEditText, Mode=OneWay}"/>
                <Button Content="取消" HorizontalAlignment="Right" Style="{DynamicResource MaterialDesignFlatButton}" Command="{x:Static materialDesign:DialogHost.CloseDialogCommand}" Margin="3 0 0 0" CommandParameter="{x:Null}"/>
            </StackPanel>
        </StackPanel>


        <StackPanel x:Key="ForceUpate" VerticalAlignment="Stretch" Margin="40" MaxWidth="400">
            <TextBlock Margin="20 0 0 5" Style="{StaticResource MaterialDesignHeadline6TextBlock}">
        <Run Text="强制更新"/>
            </TextBlock>
            <TextBlock Margin="35 10 0 2" TextWrapping="Wrap">
        <Run Text="确定吗？"/>
            </TextBlock>
            <StackPanel Orientation="Horizontal" Margin="0 8 0 0" HorizontalAlignment="Right">
                <Button Content="确定" HorizontalAlignment="Right" Style="{DynamicResource MaterialDesignFlatButton}" Command="{x:Static materialDesign:DialogHost.CloseDialogCommand}" 
              Click="ButtonUpate_OnClick">
                    <Button.CommandParameter>
                        <system:Boolean xmlns:system="clr-namespace:System;assembly=mscorlib">
                            True
                        </system:Boolean>
                    </Button.CommandParameter>
                </Button>
                <Button Content="取消" HorizontalAlignment="Right" Style="{DynamicResource MaterialDesignFlatButton}" Command="{x:Static materialDesign:DialogHost.CloseDialogCommand}" Margin="6 0 0 0">
                    <Button.CommandParameter>
                        <system:Boolean xmlns:system="clr-namespace:System;assembly=mscorlib">
                            False
                        </system:Boolean>
                    </Button.CommandParameter>
                </Button>
            </StackPanel>
        </StackPanel>



        <StackPanel x:Key="EditTagDialog" VerticalAlignment="Stretch" Margin="16" MaxWidth="400">
            <TextBlock Style="{StaticResource MaterialDesignHeadline6TextBlock}" Text="编辑标签名称"/>
            <TextBox Margin="0 6 0 0" TextWrapping="Wrap"
                     Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                     Text="{Binding ViewModel.TagEditText}"
                     materialDesign:HintAssist.Hint="标签名称"/>
            <StackPanel Orientation="Horizontal" Margin="0 8 0 0" HorizontalAlignment="Right">
                <Button Content="确定" HorizontalAlignment="Right" Style="{DynamicResource MaterialDesignFlatButton}" Command="{x:Static materialDesign:DialogHost.CloseDialogCommand}" 
                        CommandParameter="{Binding ViewModel.TagEditText, Mode=OneWay}"/>
                <Button Content="取消" HorizontalAlignment="Right" Style="{DynamicResource MaterialDesignFlatButton}" Command="{x:Static materialDesign:DialogHost.CloseDialogCommand}" Margin="6 0 0 0" CommandParameter="{x:Null}"/>
            </StackPanel>
        </StackPanel>

        <Grid x:Key="ExitConfirm" VerticalAlignment="Stretch" Margin="50 20 50 2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- 为TextBlock定义行高 -->
                <RowDefinition Height="Auto"/>
                <!-- 为账户Label和TextBox定义行高 -->
                <RowDefinition Height="Auto"/>
                <!-- 为密码Label和TextBox定义行高 -->
                <RowDefinition Height="*"/>
                <!-- 为保存按钮定义行高 -->
            </Grid.RowDefinitions>

            <TextBlock Style="{StaticResource MaterialDesignHeadline6TextBlock}"
        Grid.Row="0" 
        VerticalAlignment="Center" 
        HorizontalAlignment="Center"
        Margin="20">
 <Run Text="填写账户密码"/>
            </TextBlock>

            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="60,0,60,20">
                <Label Content="账户:" Target="{Binding ElementName=AccountTextBox}" />
                <TextBox x:Name="AccountTextBox" Margin="10,0,0,0" Width="200" />
            </StackPanel>

            <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="60,0,60,20">
                <Label Content="密码:" Target="{Binding ElementName=passwordTextBox}" />
                <TextBox x:Name="passwordTextBox" Margin="10,0,0,0" Width="200" />
            </StackPanel>

            <Grid Grid.Row="3" Margin="0,20,0,0" HorizontalAlignment="Stretch">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Button Grid.Column="0" Content="保存" 
         HorizontalAlignment="Stretch" 
         Style="{DynamicResource MaterialDesignFlatButton}" 
         Command="{x:Static materialDesign:DialogHost.CloseDialogCommand}">
                    <Button.CommandParameter>
                        <system:Boolean xmlns:system="clr-namespace:System;assembly=mscorlib">True</system:Boolean>
                    </Button.CommandParameter>
                </Button>
            </Grid>
        </Grid>
    </Window.Resources>
    
    
    

    <materialDesign:DialogHost Identifier="SettingsWindow">
        <materialDesign:DrawerHost RightDrawerContent="{Binding ViewModel.DrawerContent, Mode=OneWay}"
                                   DrawerClosing="MyDrawerHost_OnDrawerClosing"
                                   x:Name="MyDrawerHost">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <!-- 内容 -->
                <TabControl Grid.Column="2" Grid.Row="1" TabStripPlacement="Left" x:Name="RootTabControl">
                    <!-- 基本 -->
                    <TabItem  Header="基本">
                        <ScrollViewer >
                            <StackPanel Style="{StaticResource SettingsPageStackPanelStyle}">
                                <ely:IconText Kind="CogOutline" Text="基本" Margin="0 0 0 8"/>
                                <!-- 开机自启 -->
                                <ely:SettingsCard IconGlyph="AutomaticStart" Header="开机自启"
                                                       Description="在系统启动时自动运行本应用。"
                                                       IsOn="{Binding Settings.IsAutoStartEnabled, Mode=TwoWay}" />
                                <!-- 窗口置底 -->
                                <ely:SettingsCard IconGlyph="LayersOutline" Header="窗口置底"
                                                  Description="将窗口置于底端。"
                                                  IsOn="{Binding Settings.IsBottom, Mode=TwoWay}" />
                                <!-- 窗口标题 -->
                                <ely:SettingsCard IconGlyph="DesktopWindows" Header="窗口标题"
                                                  Description="在窗口上显示的标题。">
                                    <ely:SettingsCard.Switcher>
                                        <TextBox MinWidth="150" Text="{Binding Settings.Title}"/>
                                    </ely:SettingsCard.Switcher>
                                </ely:SettingsCard>
                                <!-- 最大面板宽度 -->
                                <ely:SettingsCard IconGlyph="DesktopWindows" Header="最大面板宽度"
                                                  Description="当作业超出显示范围换行时，各个列面板的最大宽度。">
                                    <ely:SettingsCard.Switcher>
                                        <ely:NumbericTextBox MinWidth="150" 
                                                             Style="{StaticResource MaterialDesignTextBox}"
                                                             Text="{Binding Settings.MaxPanelWidth, Converter={StaticResource IntToStringConverter}}"
                                                             MinValue="0"
                                                             MaxValue="2000"
                                                             materialDesign:TextFieldAssist.SuffixText="px"/>
                                    </ely:SettingsCard.Switcher>
                                </ely:SettingsCard>
                                <ely:SettingsCard IconGlyph="Assignment" Header="自动清除作业"
                                    Description="启动时有作业过期时，清除过期的作业。"
                                  IsOn="{Binding Settings.lsclearances, Mode=TwoWay}" />

                                <ely:IconText Kind="LedOn" Text="其他" Margin="0 0 0 8"/>
                                
                                    <ely:SettingsCard IconGlyph="LayersOutline" Header="窗口置底"
                                 Description="将窗口置于底端。"
                                  IsOn="{Binding Settings.IsBottom, Mode=TwoWay}" />

                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>

                    <!-- 外观 -->
                    <TabItem Header="外观">
                        <ScrollViewer>
                            <StackPanel Style="{StaticResource SettingsPageStackPanelStyle}">
                                <ely:IconText Kind="CogOutline" Text="基本" Margin="0 0 0 8"/>
                                <!-- 界面缩放 -->
                                <ely:SettingsCard IconGlyph="ZoomInOutline" Header="界面缩放"
                                                       Description="主界面的缩放比例。">
                                    <ely:SettingsCard.Switcher>
                                        <Slider Width="180" Minimum="0.75" Maximum="5"
                                                VerticalAlignment="Center"
                                                Value="{Binding Settings.Scale}"
                                                AutoToolTipPlacement="BottomRight"
                                                TickFrequency="0.05"
                                                TickPlacement="None"
                                                IsSnapToTickEnabled="True"
                                                AutoToolTipPrecision="2" />
                                    </ely:SettingsCard.Switcher>
                                </ely:SettingsCard>
                                <!-- 背景透明度 -->
                                <ely:SettingsCard IconGlyph="SquareTransparent" Header="背景不透明度"
                                                       Description="课表背景颜色的不透明度。">
                                    <ely:SettingsCard.Switcher>
                                        <Slider Width="180" Minimum="0" Maximum="1"
                                                Value="{Binding Settings.Opacity}"
                                                AutoToolTipPlacement="BottomRight"
                                                TickFrequency="0.01"
                                                IsSnapToTickEnabled="True"
                                                AutoToolTipPrecision="2" />
                                    </ely:SettingsCard.Switcher>
                                </ely:SettingsCard>
                                <Separator Margin="0 16 0 8"/>
                                <ely:IconText Kind="PaletteOutline" Text="主题" Margin="0 0 0 8"/>
                                <!-- 应用主题 -->
                                <ely:SettingsCard IconGlyph="ThemeLightDark" Header="应用主题"
                                                       Description="控制应用的明暗主题。">
                                    <ely:SettingsCard.Switcher>
                                        <ComboBox Foreground="{DynamicResource MaterialDesignBody}"
                                                  SelectedIndex="{Binding Settings.Theme}"
                                                  HorizontalContentAlignment="Left">
                                            <ComboBoxItem HorizontalContentAlignment="Left">
                                                <ely:IconText Kind="ThemeLightDark" Text="跟随系统" />
                                            </ComboBoxItem>
                                            <ComboBoxItem HorizontalContentAlignment="Left">
                                                <ely:IconText Kind="WhiteBalanceSunny" Text="明亮" />
                                            </ComboBoxItem>
                                            <ComboBoxItem HorizontalContentAlignment="Left">
                                                <ely:IconText Kind="WeatherNight" Text="黑暗" />
                                            </ComboBoxItem>
                                        </ComboBox>
                                    </ely:SettingsCard.Switcher>
                                </ely:SettingsCard>
                                <!-- 主题色来源 -->
                                <ely:SettingsCard IconGlyph="PaletteSwatchOutline" Header="主题色来源"
                                                       Description="控制应用选取主题色的途径。">
                                    <ely:SettingsCard.Switcher>
                                        <ComboBox Foreground="{DynamicResource MaterialDesignBody}"
                                                  HorizontalContentAlignment="Left"
                                                  SelectedIndex="{Binding Settings.ColorSource}">
                                            <ComboBoxItem HorizontalContentAlignment="Left">
                                                <ely:IconText Kind="UserOutline" Text="自定义" />
                                            </ComboBoxItem>
                                            <ComboBoxItem HorizontalContentAlignment="Left">
                                                <ely:IconText Kind="Wallpaper" Text="系统壁纸" />
                                            </ComboBoxItem>
                                            <ComboBoxItem HorizontalContentAlignment="Left">
                                                <ely:IconText Kind="MicrosoftWindows" Text="系统" />
                                            </ComboBoxItem>
                                        </ComboBox>
                                    </ely:SettingsCard.Switcher>
                                </ely:SettingsCard>
                                <StackPanel>
                                    <StackPanel.Style>
                                        <Style TargetType="StackPanel">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Settings.ColorSource}" Value="0">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                        </Style>
                                    </StackPanel.Style>
                                    <!-- 第一主题色 -->
                                    <ely:SettingsCard IconGlyph="PaletteOutline" Header="第一主题色"
                                                           Description="应用主要显示的主题颜色。">
                                        <ely:SettingsCard.Switcher>
                                            <ely:ColorPicker Color="{Binding Settings.PrimaryColor, Mode=TwoWay}" />
                                        </ely:SettingsCard.Switcher>
                                    </ely:SettingsCard>
                                    <!-- 第二主题色 -->
                                    <ely:SettingsCard IconGlyph="PaletteOutline" Header="第二主题色"
                                                           Description="应用次要显示的主题颜色。">
                                        <ely:SettingsCard.Switcher>
                                            <ely:ColorPicker
                                                Color="{Binding Settings.SecondaryColor, Mode=TwoWay}" />
                                        </ely:SettingsCard.Switcher>
                                    </ely:SettingsCard>
                                </StackPanel>
                                <!-- 壁纸主题色 -->
                                <StackPanel>
                                    <StackPanel.Style>
                                        <Style TargetType="StackPanel">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Settings.ColorSource}" Value="1">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                        </Style>
                                    </StackPanel.Style>
                                    <Separator Margin="0 16 0 8"/>
                                    <ely:IconText Kind="Wallpaper" Text="壁纸主题色" Margin="0 0 0 8"/>
                                    <Grid>
                                        <StackPanel Margin="12">
                                            <ely:IconText Kind="PaletteOutline" Text="选择主题色" />
                                            <Grid VerticalAlignment="Bottom"
                                      IsEnabled="{Binding WallpaperPickingService.IsWorking, Mode=OneWay, Converter={StaticResource BooleanToBooleanReConverter}}">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <WrapPanel HorizontalAlignment="Right"
                                               VerticalAlignment="Center"
                                               Grid.Column="1">
                                                    <!-- 刷新 -->
                                                    <Button Style="{StaticResource MaterialDesignFlatButton}"
                                                Click="ButtonUpdateWallpaper_OnClick"
                                                VerticalAlignment="Center"
                                                Margin="2 0">
                                                        <ely:IconText Kind="Refresh" Text="刷新" />
                                                    </Button>
                                                    <!-- 预览提取结果 -->
                                                </WrapPanel>
                                                <!-- 颜色选择 -->
                                                <ListBox Grid.Column="0"
                     ItemsSource="{Binding SettingsService.Settings.WallpaperColorPlatte, Mode=OneWay}"
                     SelectedIndex="{Binding SettingsService.Settings.SelectedPlatteIndex}"
                     materialDesign:ScrollViewerAssist.BubbleVerticalScroll="True"
                     PreviewMouseWheel="UIElement_OnPreviewMouseWheel"
                     HorizontalAlignment="Left">
                                                    <ListBox.ItemsPanel>
                                                        <ItemsPanelTemplate>
                                                            <WrapPanel IsItemsHost="True" />
                                                        </ItemsPanelTemplate>
                                                    </ListBox.ItemsPanel>
                                                    <ListBox.ItemTemplate>
                                                        <DataTemplate>
                                                            <materialDesign:ColorZone
                                                    Background="{Binding Converter={StaticResource ColorToColorPickerBrushConverter}}"
                                                    Width="32" Height="32"
                                                    Mode="Custom">
                                                                <materialDesign:PackIcon Kind="Check"
                                                        VerticalAlignment="Bottom"
                                                        HorizontalAlignment="Right"
                                                        Width="14" Height="14"
                                                        Background="White"
                                                        Foreground="Black"
                                                        Visibility="{Binding IsSelected, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListBoxItem}}, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                                            </materialDesign:ColorZone>
                                                        </DataTemplate>
                                                    </ListBox.ItemTemplate>
                                                </ListBox>
                                            </Grid>
                                            <!-- Loading -->
                                            <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                              Visibility="{Binding WallpaperPickingService.IsWorking, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                <Border HorizontalAlignment="Stretch" VerticalAlignment="Stretch" 
                                                    Background="{DynamicResource MaterialDesignPaper}"
                                                    Opacity="0.8"/>
                                                <ely:StarRailLoadingControl/>
                                            </Grid>
                                        </StackPanel>
                                    </Grid>
                                    <!-- 启用自动提取主题色 -->
                                    <ely:SettingsCard IconGlyph="RefreshAuto" Header="启用自动提取主题色" Margin="0 12 0 6"
                                                           Description="若启用，将会在每分钟刷新一次壁纸主题色，适用于会随时间大幅变化主题色的动态壁纸。"
                                                           IsOn="{Binding Settings.IsWallpaperAutoUpdateEnabled, Mode=TwoWay}"/>
                                    <!-- 自动提取主题色间隔 -->
                                    <ely:SettingsCard IconGlyph="ClockOutline" Header="自动提取主题色间隔"
                                                           Description="自动从壁纸提取主题色时间隔的时间，建议以动态壁纸更新速度按需设置，不宜低于10秒。">
                                        <ely:SettingsCard.Switcher>
                                            <ely:NumbericTextBox MaxValue="36000" MinValue="0" Width="150"
                                                                      materialDesign:TextFieldAssist.SuffixText="秒"
                                                                      Foreground="{DynamicResource MaterialDesignBody}"
                                                                      Style="{StaticResource MaterialDesignTextBox}"
                                                                      Text="{Binding Settings.WallpaperAutoUpdateIntervalSeconds, Mode=TwoWay, Converter={StaticResource IntToStringConverter}}"/>
                                        </ely:SettingsCard.Switcher>
                                    </ely:SettingsCard>
                                    <!-- 兼容模式 -->
                                    <ely:SettingsCard IconGlyph="CogOutline" Header="启用兼容模式"
                                                           Description="若启用，将从注册表提取壁纸，而非桌面句柄，不兼容动态壁纸。可能可以解决一些壁纸提取中的玄学问题。"
                                                           IsOn="{Binding Settings.IsFallbackModeEnabled, Mode=TwoWay}"/>
                                    <!-- 壁纸层窗口类名 -->
                                    <ely:SettingsCard IconGlyph="WindowMaximize" Header="壁纸层窗口类名"
                                                           Description="获取壁纸时要寻找的壁纸窗口的类名，留空将使用默认类名Progman。当需要从动态壁纸软件（如Wallpaper Engine等）获取壁纸时，请修改此选项为对应壁纸软件的壁纸窗口类名，以正确获取壁纸。若此栏未填写正确，将无法正常获取壁纸。">
                                        <ely:SettingsCard.Switcher>
                                            <DockPanel Width="150">
                                                <Button Style="{StaticResource MaterialDesignFlatButton}"
                                                        Content="{materialDesign:PackIcon WindowMaximize}"
                                                        ToolTip="浏览…"
                                                        DockPanel.Dock="Right"
                                                        Click="ButtonBrowseWindows_OnClick"/>
                                                <TextBox Foreground="{DynamicResource MaterialDesignBody}"
                                                         Text="{Binding Settings.WallpaperClassName}"/>
                                            </DockPanel>
                                        </ely:SettingsCard.Switcher>
                                    </ely:SettingsCard>
                                    <!-- 取色亮度波峰 -->
                                    <ely:SettingsCard IconGlyph="ChartBellCurve" Header="取色亮度波峰"
                                                           Description="取色时为亮度更接近此值的颜色赋予更高的权重，修改此值会影响到取色结果中整体颜色的亮度和准确性，请谨慎修改。（默认值：0.6）">
                                        <ely:SettingsCard.Switcher>
                                            <ely:NumbericTextBox MaxValue="1" MinValue="0" Width="150"
                                                                      Foreground="{DynamicResource MaterialDesignBody}"
                                                                      Style="{StaticResource MaterialDesignTextBox}"
                                                                      Text="{Binding Settings.TargetLightValue, Mode=TwoWay, Converter={StaticResource IntToStringConverter}}"/>
                                        </ely:SettingsCard.Switcher>
                                    </ely:SettingsCard>
                                </StackPanel>
                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>

                    <!-- 更新 -->
                    <TabItem Header="更新">
                        <ScrollViewer>
                            <StackPanel Margin="6" MaxWidth="1000">
                                <StackPanel>
                                    <!-- banner -->
                                    <!--<Grid Height="100">
     <Image Source="/Assets/banner.png" Stretch="UniformToFill" HorizontalAlignment="Center" VerticalAlignment="Center"/>
 </Grid>-->
                                    <Grid HorizontalAlignment="Stretch" Margin="12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <!-- icon -->
                                        <materialDesign:Ripple Grid.Column="0" VerticalAlignment="Top"
                                            MouseDown="AppIcon_OnMouseDown">
                                            <!-- TODO: 图标 -->
                                            <Image  x:Name="statusIcon" Source="/Assets/icon/帮助.png" Width="49"
                                Height="90" VerticalAlignment="Top" />
                                        </materialDesign:Ripple>
                                        <!-- about -->
                                        <StackPanel Grid.Column="1" Margin="5 0 0 0">
                                            <TextBlock>
                                 <Run Text="未获取更新" x:Name="versionStatusTextBlock" FontSize="38" FontWeight="Medium" />
                                 <LineBreak />
                                <TextBlock Margin="-1" >
                                      <Run         x:Name="versionStatusTexts"      Text="当前版本：" FontWeight="Bold" FontSize="18"/>
                                      <Run        x:Name="versionStatusText"       Text="{x:Static ci:App.AppVersion}" FontSize="18" />
                                  </TextBlock>
                                     <LineBreak />
                                     <LineBreak />
                                     <ProgressBar x:Name="pbDown" Height="5" Width="500" Margin="0 -3 0 0" IsIndeterminate="True"  Minimum="0"  Maximum="100"  />
                                      <Label Name="labelProgress" Content="加载中" Visibility="Collapsed" />
                                            </TextBlock>
                                            <WrapPanel>
                                                <Button HorizontalAlignment="Left" Margin="10" 
                               Style="{StaticResource MaterialDesignFlatButton}"
                               Click="Check_for_updates"
                               BorderBrush="{DynamicResource MaterialDesignDivider}" 
                                                    BorderThickness="1"
                                                    Background="Transparent">
                                                    <ely:IconText Kind="restart" Text="检查并更新"/>
                                                </Button>
                                            </WrapPanel>
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                                <emoji:TextBlock ColorBlend="True" FontSize="20" Text="更新日志🏷️" HorizontalAlignment="Center"/>
                                <mdxam:MarkdownScrollViewer MarkdownStyle="{StaticResource CustomMarkdownStyle}" xml:space="preserve" FontFamily="Microsoft YaHei" FontSize="16">
***             
***                        
>

## **【修复🐛】**
* 修复图片导出时的问题。
* 修复出错时选择文件无法替换的问题。
* 修改部分界面的协调性。
* 修复托盘退出时无法保存位置的问题。
* 更新界面优化。
                
##**【添加🚀】**
* 添加选择表情界面（早期开发）。
* 添加调试时的控制台，在发布时将自动关闭。
* 添加托盘'显示与隐藏‘。
* 添加应用初始化时进行对比当前窗口参数是否与setting一致。
* 添加强制更新功能（实验性）。
* 
                                </mdxam:MarkdownScrollViewer>
                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>


                    <TabItem Header="备份">
                        <ScrollViewer>
                            <StackPanel Style="{StaticResource SettingsPageStackPanelStyle}">
                                <ely:IconText Kind="AccountPending" Text="备份" Margin="0 0 0 8"/>


                                <ely:SettingsCard IconGlyph="PenPlus" Header="编写作业时"
                               Description="编写作业时进行自动备份。"
                               IsOn="{Binding Settings.IsBottom, Mode=TwoWay}" />

                                <ely:SettingsCard IconGlyph="TouchReading" Header="启动应用时"
                               Description="启动时进行自动备份。"
                               IsOn="{Binding Settings.IsBottom, Mode=TwoWay}" />

                                <ely:IconText Kind="Cloud" Text="WebDav" Margin="0 0 0 8"/>

                                <ely:SettingsCard IconGlyph="Cloud" Header="启用WebDav" 
                               Description="启用后可以使用该功能。"
             IsOn="{Binding Settings.IsBottom, Mode=TwoWay}" />



                                <ely:SettingsCard IconGlyph="Key" Header="WebDav账户"
    Description="首次使用该功能时，需要填写服务商链接和提供给您的账户和密码。">
                                    <ely:SettingsCard.Switcher>
                                        <DockPanel Width="60">
                                            <Button Content="{materialDesign:PackIcon Edit, Size=20}" ToolTip="编辑" 
                 Command="{x:Static materialDesign:DialogHost.OpenDialogCommand}"
                 CommandParameter="{StaticResource ExitConfirm}"/>
                                        </DockPanel>
                                    </ely:SettingsCard.Switcher>
                                </ely:SettingsCard>

                                <ely:SettingsCard IconGlyph="CloudUpload" Header="自动上传截图"
                               Description="每天自动在您设置的时间点截图并上传WebDav。"
                               IsOn="{Binding Settings.IsBottom, Mode=TwoWay}"
                               />

                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>



                    <!-- 科目 -->
                    <TabItem Header="科目">
                        <Grid Margin="12" MaxWidth="750">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <DockPanel Grid.Row="0" Margin="0 0 0 8">
                                <Button DockPanel.Dock="Right" Click="ButtonAddSubject_OnClick"
                                        Style="{StaticResource MaterialDesignFlatButton}">
                                    <ely:IconText Kind="Add" Text="添加科目" />
                                </Button>
                                <TextBlock Text="科目" VerticalAlignment="Center" />
                            </DockPanel>
                            <ListBox Grid.Row="1" ItemsSource="{Binding Settings.Subjects}"
                                     SelectionMode="Single"
                                     HorizontalContentAlignment="Stretch"
                                     SelectedIndex="{Binding ViewModel.SubjectSelectedIndex}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="{Binding}" VerticalAlignment="Center" />
                                            <StackPanel Grid.Column="1" Orientation="Horizontal"
                                                        Visibility="{Binding IsSelected, RelativeSource={RelativeSource FindAncestor, AncestorType=ListBoxItem}, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                <Button Content="{materialDesign:PackIcon EditOutline}"
                                                        Style="{StaticResource MaterialDesignToolForegroundButton}"
                                                        Margin="4 -8" ToolTip="编辑" Click="ButtonEditSubject_OnClick" />
                                                <Button Content="{materialDesign:PackIcon DeleteOutline}"
                                                        Style="{StaticResource MaterialDesignToolForegroundButton}"
                                                        Margin="4 -8" ToolTip="删除" Foreground="IndianRed"
                                                        Click="ButtonDeleteSubject_OnClick" />
                                            </StackPanel>
                                        </Grid>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Grid>
                    </TabItem>

                    <!-- 标签 -->
                    <TabItem Header="标签">
                        <Grid Margin="12" MaxWidth="750">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <DockPanel Grid.Row="0" Margin="0 0 0 8">
                                <Button DockPanel.Dock="Right" Click="ButtonAddTag_OnClick"
                                        Style="{StaticResource MaterialDesignFlatButton}">
                                    <ely:IconText Kind="Add" Text="添加标签" />
                                </Button>
                                <TextBlock Text="快捷插入" VerticalAlignment="Center" />
                            </DockPanel>
                            <ListBox Grid.Row="1" ItemsSource="{Binding Settings.Tags}"
                                     SelectionMode="Single"
                                     HorizontalContentAlignment="Stretch"
                                     SelectedIndex="{Binding ViewModel.TagSelectedIndex}"
                                     Style="{StaticResource MaterialDesignChoiceChipOutlineListBox}">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="{Binding}" VerticalAlignment="Center" />
                                            <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="5 0 0 0"
                                                        Visibility="{Binding IsSelected, RelativeSource={RelativeSource FindAncestor, AncestorType=ListBoxItem}, Converter={StaticResource BooleanToVisibilityConverter}}">
                                                <Button Content="{materialDesign:PackIcon EditOutline, Size=16}"
                                                        Style="{StaticResource MaterialDesignToolForegroundButton}"
                                                        Margin="0 -8" ToolTip="编辑" Click="ButtonEditTag_OnClick" />
                                                <Button Content="{materialDesign:PackIcon DeleteOutline, Size=16}"
                                                        Style="{StaticResource MaterialDesignToolForegroundButton}"
                                                        Margin="0 -8" ToolTip="删除" Foreground="IndianRed"
                                                        Click="ButtonDeleteTag_OnClick" />
                                            </StackPanel>
                                        </Grid>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Grid>
                    </TabItem>

                    <!-- 关于 -->
                    <TabItem Header="关于">
                        <ScrollViewer>
                            <StackPanel Margin="6" MaxWidth="750">
                                <StackPanel>
                                    <!-- banner -->
                                    <!--<Grid Height="100">
                        <Image Source="/Assets/banner.png" Stretch="UniformToFill" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Grid>-->
                                    <Grid HorizontalAlignment="Stretch" Margin="12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition />
                                        </Grid.ColumnDefinitions>
                                        <!-- icon -->
                                        <materialDesign:Ripple Grid.Column="0" VerticalAlignment="Top"
                                                               MouseDown="AppIcon_OnMouseDown">
                                            <!-- TODO: 应用图标 -->
                                            <Image Source="/Assets/AppLogo.ico" Width="40"
                                                   Height="40" VerticalAlignment="Top" />
                                        </materialDesign:Ripple>
                                        <!-- about -->
                                        <StackPanel Grid.Column="1" Margin="10 0 0 0">
                                            <TextBlock>
                                                    <Run Text="Sticky-attention" FontSize="24" FontWeight="Bold" />
                                                    <LineBreak />
                                                    <Run Text="{x:Static ci:App.AppVersion}" />
                                                    <LineBreak />
                                                    <Run Text="Copyright (c) 2024 JIzilin" />
                                            </TextBlock>
                                            <WrapPanel>
                                                <Button HorizontalAlignment="Left" Margin="6"
                                                 Style="{StaticResource MaterialDesignFlatButton}"
                                                 Click="OpenGitHub_Click">
                                                  <ely:IconText Kind="MicrosoftGithub" Text="GitHub"/>
                                                </Button>

                                                <Button HorizontalAlignment="Left" Margin="6"
                                                            Style="{StaticResource MaterialDesignFlatButton}"
                                                            Command="{x:Static materialDesign:DialogHost.OpenDialogCommand}">
                                                    <ely:IconText Kind="License" Text="开源许可"/>
                                                    <Button.CommandParameter>
                                                        <StaticResource ResourceKey="OpenSourceLicense" />
                                                    </Button.CommandParameter>
                                                </Button>

                                            </WrapPanel>
                                        </StackPanel>
                                    </Grid>

                                </StackPanel>

                                <FlowDocumentScrollViewer ScrollViewer.VerticalScrollBarVisibility="Disabled"
                                                          IsSelectionEnabled="False"
                                                          PreviewMouseWheel="UIElement_OnPreviewMouseWheel"
                                                          ContextMenu="{x:Null}">
                                    <FlowDocument FontFamily="{StaticResource MiSans}">
                                        <Paragraph Style="{StaticResource MarkdownHeadline1Style}">
                                            关于本应用
                                        </Paragraph>
                                        <Paragraph>
                                            本项目受到StickyHomeworks的启发而开发。
                                            <LineBreak/>
                                            界面主题和部分控件使用了WPF 框架。
                                            <LineBreak/>
                                            应用字体使用了小米开源的MiSans。
                                            <LineBreak/>
                                            感谢Shompinice提供应用图标。
                                            <LineBreak/>
                                            感谢jizilin为本项目提供的下载与更新资源网站。
                                            <LineBreak/>
                                            感谢unDefFtr与hello8693为本项目提供的下载资源网站。
                                            <LineBreak/>
                                            部分图像资源 (/Assets/*)来自米游社表情包，版权归 miHoYo所有。
                                            <LineBreak/>
                                            其他使用的第三方库和贡献成员，详见贡献名单和第三方库。
                                        </Paragraph>

                                        <Paragraph Style="{StaticResource MarkdownHeadline2Style}"
                                                   LineHeight="2">
                                            鸣谢：
                                        </Paragraph>
                                        <Paragraph>
                                            <Button HorizontalAlignment="Left" Margin="6"
                                                    Style="{StaticResource MaterialDesignFlatButton}"
                                                    Click="ButtonContributors_OnClick">
                                                <ely:IconText Kind="PeopleGroupOutline" Text="贡献人员" />
                                            </Button>
                                            <Button HorizontalAlignment="Left" Margin="6"
                                                    Style="{StaticResource MaterialDesignFlatButton}"
                                                    Click="ButtonThirdPartyLibs_OnClick">
                                                <ely:IconText Kind="PackageVariant" Text="第三方库与其他组织" />
                                            </Button>
                                        </Paragraph>

                                        <Paragraph Foreground="red">
                                            永远爱中国！
                                        </Paragraph>

                                    </FlowDocument>
                                </FlowDocumentScrollViewer>

                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>

                    <!-- 调试 -->
                    <TabItem Header="调试">
                        <ScrollViewer>
                            <StackPanel Style="{StaticResource SettingsPageStackPanelStyle}">
                                <StackPanel.Resources>
                                    <Style TargetType="MenuItem" BasedOn="{StaticResource MaterialDesignMenuItem}">
                                        <Style.Resources>
                                            <Style TargetType="materialDesign:PackIcon">
                                                <Setter Property="Foreground" Value="{DynamicResource PrimaryHueMidBrush}"/>
                                            </Style>
                                        </Style.Resources>
                                    </Style>
                                </StackPanel.Resources>
                                <TextBlock Text="调试" Style="{StaticResource MaterialDesignHeadline5TextBlock}"/>
                                <TextBlock Margin="0 12">
                                    <Run Text="仅供调试，除非你能知道您在做什么，请不要使用以下按钮。"></Run>
                                </TextBlock>

                                <MenuItem Icon="{materialDesign:PackIcon BugOutline}" Header="崩溃测试" Click="ButtonCrash_OnClick"/>
                                <MenuItem IsCheckable="True" IsChecked="{Binding Settings.IsDebugShowInTaskBar}" Header="在任务栏显示图标"/>
                                <MenuItem Icon="{materialDesign:PackIcon LightningBoltOutline}" Header="测试作业编辑窗口" Click="MenuItemTestHomeworkEditWindow_OnClick"/>
                                <MenuItem Icon="{materialDesign:PackIcon cancel}" Header="不保留数据关闭应用" Click="ButtonExit_OnClick"/>
                                <MenuItem Icon="{materialDesign:PackIcon Kind=W3c}" Header="向sdk发送nh实例" Click="MenuItem_Click"/>
                                <RichTextBox>
                                    <FlowDocument IsHyphenationEnabled="False"
                                                  IsOptimalParagraphEnabled="True">
                                        
                                    </FlowDocument>
                                </RichTextBox>
                                <TextBox Text="{Binding ViewModel.DebugRichTextBoxContent, Mode=TwoWay}"/>
                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>
                </TabControl>

                <materialDesign:ColorZone Grid.Column="0" Grid.ColumnSpan="3" Grid.Row="0" Padding="16" Mode="PrimaryMid"
                                          materialDesign:ElevationAssist.Elevation="Dp4"
                                          Margin="0 0 0 4">
                    <Grid Margin="4 0 4 0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <!--<ToggleButton Grid.Column="0"
                            Style="{StaticResource MaterialDesignHamburgerToggleButton}" />-->
                        <!--<Button ToolTip="导航栏"
                                VerticalAlignment="Center"
                                Padding="0"
                                Style="{StaticResource MaterialDesignToolForegroundButton}"
                                Content="{materialDesign:PackIcon Menu, Size=24}"/>-->
                        <TextBlock Grid.Column="1" Text="应用设置" Style="{StaticResource MaterialDesignHeadline6TextBlock}"
                                   HorizontalAlignment="Left"
                                   Margin="0 0 0 0"
                                   VerticalAlignment="Center"/>
                        <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">

                            <TextBlock Margin="1">
                          <Run Text="当前版本：" FontWeight="Bold" FontSize="15"/>
                          <Run Text="{x:Static ci:App.AppVersion}" FontSize="15" />
                            </TextBlock>
                            
                            

                            <materialDesign:PopupBox Margin="8 0 -8 0" ToolTip="更多选项…" StaysOpen="False"
                                                     IsPopupOpen="{Binding ViewModel.IsPopupMenuOpened, Mode=TwoWay}">
                                <StackPanel>
                                    <MenuItem Icon="{materialDesign:PackIcon Code}" Header="实验性功能…" Click="MenuItemExperimentalSettings_OnClick"/>
                                    <MenuItem Header="强制更新" Icon="{materialDesign:PackIcon ArrowUpBox}" Command="{x:Static materialDesign:DialogHost.OpenDialogCommand}" CommandParameter="{StaticResource ForceUpate}" />

                                </StackPanel>
                            </materialDesign:PopupBox>
                        </StackPanel>
                    </Grid>
                </materialDesign:ColorZone>
            </Grid>
        </materialDesign:DrawerHost>
    </materialDesign:DialogHost>
</ely:MyWindow>
